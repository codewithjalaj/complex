(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{212:function(e,a){},218:function(e,a,t){"use strict";t.r(a);var s=t(0),r=t.n(s),c=t(3),n=t(15),l=t(185),m=t.n(l),i=t(7),o=t(14);a.default=function(e){const a=Object(s.useRef)(null),t=Object(s.useContext)(i.a),l=Object(s.useContext)(o.a),u=Object(s.useRef)(null),h=Object(s.useRef)(null),[g,p]=Object(n.a)({messageField:"",chatMessages:[]});return Object(s.useEffect)(()=>{t.isChatOpen&&(u.current.focus(),l({type:"clearUnreadMessageCount"}))},[t.isChatOpen]),Object(s.useEffect)(()=>(a.current=m()("http://localhost:8080"),a.current.on("chatFromServer",e=>{p(a=>{a.chatMessages.push(e)})}),()=>a.current.disconnect()),[]),Object(s.useEffect)(()=>{h.current.scrollTop=h.current.scrollHeight,g.chatMessages.length&&!t.isChatOpen&&l({type:"incrementUnreadMessageCount"})},[g.chatMessages]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"chat-wrapper",className:"chat-wrapper shadow border-top border-left border-right"+(t.isChatOpen?" chat-wrapper--is-visible":"")},r.a.createElement("div",{className:"chat-title-bar bg-primary"},"Chat",r.a.createElement("span",{onClick:()=>l({type:"closeChat"}),className:"chat-title-bar-close"},r.a.createElement("i",{className:"fas fa-times-circle"}))),r.a.createElement("div",{id:"chat",ref:h,className:"chat-log"},g.chatMessages.map((e,a)=>e.username==t.userDetails.username?r.a.createElement("div",{key:a,className:"chat-self"},r.a.createElement("div",{className:"chat-message"},r.a.createElement("div",{className:"chat-message-inner"},e.message)),r.a.createElement("img",{className:"chat-avatar avatar-tiny",src:e.avatar})):r.a.createElement("div",{key:a,className:"chat-other"},r.a.createElement(c.b,{to:"/profile/"+e.username},r.a.createElement("img",{className:"avatar-tiny",src:e.avatar})),r.a.createElement("div",{className:"chat-message"},r.a.createElement("div",{className:"chat-message-inner"},r.a.createElement(c.b,{to:"/profile/"+e.username},r.a.createElement("strong",null,e.username,":"))," ",e.message))))),r.a.createElement("form",{onSubmit:e=>{e.preventDefault(),g.messageField.length&&(a.current.emit("chatFromBrowser",{message:g.messageField,token:t.userDetails.token}),p(e=>{e.messageField="",e.chatMessages.push({message:g.messageField,avatar:t.userDetails.avatar,username:t.userDetails.username})}))},id:"chatForm",className:"chat-form border-top"},r.a.createElement("input",{onChange:e=>{const a=e.target.value;p(e=>{e.messageField=a})},value:g.messageField,ref:u,type:"text",className:"chat-field",id:"chatField",placeholder:"Type a messageâ€¦",autoComplete:"off"}))))}}}]);